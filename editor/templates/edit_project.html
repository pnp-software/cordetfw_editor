{% extends "base_generic_old.html" %}
{% load crispy_forms_tags %}
{% block content %}
<div class="col-lg-10 col-xl-9">
<div class="jumbotron jumbotron-fluid bg-transparent mt-n3 mb-n5">
  <h2>Add or Edit a Project</h2>
</div>
{% crispy form %}

{% if form.errors %}
    {% for field in form %}
        {% for error in field.errors %}
            <div class="alert alert-danger">
                <strong>{{ field.name }}: {{ error|escape }}</strong>
            </div>
        {% endfor %}
    {% endfor %}
    {% for error in form.non_field_errors %}
        <div class="alert alert-danger">
            <strong>{{ error|escape }}</strong>
        </div>
    {% endfor %}
{% endif %}
</div>

<br/>

<div class="col-4">
  <div class="form-inline">
     <div class="dropdown mr-sm-2 mt-2 mb-2">
        <button class="btn btn-outline-secondary dropdown-toggle" type="button" data-toggle="dropdown">Add R/W User</button>
        <div class="dropdown-menu">
            {% for user in users %}
                <a class="dropdown-item" href="{% url 'edit_project' project.id %}?user_id={{user.id}}&role=RW">{{user.username}}</a>
            {% endfor %}
        </div>
     </div>
     <div class="dropdown mr-sm-2 mt-2 mb-2">
        <button class="btn btn-outline-secondary dropdown-toggle" type="button" data-toggle="dropdown">Add R/O User</button>
        <div class="dropdown-menu">
            {% for user in users %}
                <a class="dropdown-item" href="{% url 'edit_project' project.id %}?user_id={{user.id}}&role=RO">{{user.username}}</a>
            {% endfor %}
        </div>
     </div>
  </div> 
    <table class="table table-hover table-sm">
      <thead>
        <tr class="table-warning">
          <th>User Name</th>
          <th>Last Name</th>
          <th>First Name</th>
          <th>Role</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for project_user in project_users %}
          <tr>
            <td>{{ project_user.user.username }}</td>
            <td>{{ project_user.user.last_name }}</td>
            <td>{{ project_user.user.first_name }}</td>
            <td>{{ project_user.role }}</td>
            <td>
              <div class="btn-group">
                <a class="btn btn-outline-dark btn-sm"
                   href="{% url 'edit_project' project.id %}?del_user_id={{project_user.id}}" title="Delete Project User">D</a>
              </div> 
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
</div>
<div class="col-4">
  <div class="form-inline">
    <a class="btn btn-outline-dark btn-sm mr-sm-2 mt-3 mb-2" href="{% url 'add_val_set' project.id %}">Add ValSet</a>
  </div> 
    <table class="table table-hover table-sm">
      <thead>
        <tr class="table-warning">
          <th>Name</th>
          <th>Description</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for val_set in val_sets %}
          <tr>
            <td>{{ val_set.name }}</td>
            <td>{{ val_set.desc }}</td>
            <td>
              {% if val_set.name == 'Default' %}
                <a class="btn btn-outline-secondary disabled btn-sm" aria-disabled="true" href="#">D</a>
                <a class="btn btn-outline-secondary disabled btn-sm" aria-disabled="true" href="#">E</a>
              {% else %}
              <div class="btn-group">
                <a class="btn btn-outline-dark btn-sm"
                   href="{% url 'edit_project' project.id %}?del_val_set_id={{val_set.id}}" title="Delete ValSet">D</a>
              </div> 
              <div class="btn-group">
                <a class="btn btn-outline-dark btn-sm"
                   href="{% url 'edit_val_set' project.id val_set.id %}" title="Edit ValSet">E</a>
              </div> 
              {% endif %}
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
</div>



{% endblock %}
